!function(e,t){"function"==typeof define&&define.amd?define("vxe-table-plugin-export-xlsx",["exports","xe-utils","exceljs"],t):"undefined"!=typeof exports?t(exports,require("xe-utils"),require("exceljs")):(t(t={},e.XEUtils,e.ExcelJS),e.VXETablePluginExportXLSX=t)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,_,j){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.VXETablePluginExportXLSX=void 0,_=t(_),j=t(j);var N,O="f8f8f9",R="606266",o="thin",n="e8eaec";function A(e,t){if(t){if("seq"===e.type)return _.default.toValueString(t);switch(e.cellType){case"string":return _.default.toValueString(t);case"number":if(isNaN(t))break;return Number(t);default:if(t.length<12&&!isNaN(t))return Number(t)}}return t}function D(e,t){t&&(e.height=_.default.floor(.75*t,12))}function I(e,t){e.protection={locked:!1},e.alignment={vertical:"middle",horizontal:t||"left"}}function $(){return{top:{style:o,color:{argb:n}},left:{style:o,color:{argb:n}},bottom:{style:o,color:{argb:n}},right:{style:o,color:{argb:n}}}}function r(e){function t(){var e=new j.default.Workbook,n=e.addWorksheet(m);e.creator="vxe-table",n.columns=T,b&&n.addRows(C).forEach(function(e){E&&D(e,h),e.eachCell(function(e){var t=n.getColumn(e.col),t=u.getColumnById(t.key),o=t.headerAlign,t=t.align;I(e,o||t||l||g),E&&Object.assign(e,{font:{bold:!0,color:{argb:R}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:O}},border:$()})})}),n.addRows(B).forEach(function(e){E&&D(e,h),e.eachCell(function(e){var t=n.getColumn(e.col),t=u.getColumnById(t.key);t&&(I(e,t.align||g),E&&Object.assign(e,{font:{color:{argb:R}},border:$()}))})}),x&&n.addRows(S).forEach(function(e){E&&D(e,h),e.eachCell(function(e){var t,o=n.getColumn(e.col),o=u.getColumnById(o.key);o&&(t=o.footerAlign,o=o.align,I(e,t||o||p||g),E&&Object.assign(e,{font:{color:{argb:R}},border:$()}))})}),E&&y&&y({options:f,workbook:e,worksheet:n,columns:d,colgroups:r,datas:a,$table:u}),X.forEach(function(e){var t=e.s,e=e.e;n.mergeCells(t.r+1,t.c+1,e.r+1,e.c+1)}),e.xlsx.writeBuffer().then(function(e){var t,e=new Blob([e],{type:"application/octet-stream"}),o=f,n=(r=N).modal,r=r.t,a=o.message,l=o.filename,o=o.type,a=!1!==a;window.Blob?navigator.msSaveBlob?navigator.msSaveBlob(e,"".concat(l,".").concat(o)):((t=document.createElement("a")).target="_blank",t.download="".concat(l,".").concat(o),t.href=URL.createObjectURL(e),document.body.appendChild(t),t.click(),document.body.removeChild(t)):a&&n&&n.alert({content:r("vxe.error.notExp"),status:"error"}),k&&c&&(c.close(i),c.message({content:s("vxe.table.expSuccess"),status:"success"}))})}var o,i="xlsx",n=N,c=n.modal,s=n.t,u=e.$table,f=e.options,d=e.columns,r=e.colgroups,a=e.datas,n=u.props,e=u.reactData,l=n.headerAlign,g=n.align,p=n.footerAlign,h=e.rowHeight,n=f.message,m=f.sheetName,b=f.isHeader,x=f.isFooter,e=f.isMerge,v=f.isColgroup,w=f.original,E=f.useStyle,y=f.sheetMethod,k=!1!==n,n=u.getMergeCells(),C=[],S=[],T=[],X=[],M=0,V={},B=(d.forEach(function(e){var t=e.id,o=e.field,n=e.renderWidth,r=e.headerExportMethod;V[t]=r?r({column:e,$table:u}):w?o:e.getTitle(),T.push({key:t,width:_.default.ceil(n/8,1)})}),b&&(v&&r?r.forEach(function(e,l){var i={};d.forEach(function(e){i[e.id]=null}),e.forEach(function(e){var t=e._colSpan,o=e._rowSpan,n=e.headerExportMethod,r=function e(t){var o=t.childNodes;return o&&o.length?e(o[0]):t}(e),a=d.indexOf(r);i[r.id]=n?n({column:e,$table:u}):w?r.field:e.getTitle(),(1<t||1<o)&&X.push({s:{r:l,c:a},e:{r:l+o-1,c:a+t-1}})}),C.push(i)}):C.push(V),M+=C.length),e&&n.forEach(function(e){var t=e.row,o=e.rowspan,n=e.col,e=e.colspan;X.push({s:{r:t+M,c:n},e:{r:t+M+o-1,c:n+e-1}})}),a.map(function(t){var o={};return d.forEach(function(e){o[e.id]=A(e,t[e.id])}),o}));M+=B.length,x&&(v=u.getTableData().footerData,n=v,v=(o=f.footerFilterMethod)?n.filter(function(e,t){return o({items:e,$rowIndex:t})}):n,n=u.getMergeFooterItems(),e&&n.forEach(function(e){var t=e.row,o=e.rowspan,n=e.col,e=e.colspan;X.push({s:{r:t+M,c:n},e:{r:t+M+o-1,c:n+e-1}})}),v.forEach(function(t){var o={};d.forEach(function(e){o[e.id]=A(e,t[u.getVMColumnIndex(e)])}),S.push(o)}));k&&c?(c.message({id:i,content:s("vxe.table.expLoading"),status:"loading",duration:-1}),setTimeout(t,1500)):t()}function d(e){var t=N,o=t.modal,t=t.t,n=e.$table,e=e.options,n=n.internalData._importReject;!1!==e.message&&o&&o.message({content:t("vxe.error.impFields"),status:"error"}),n&&n({status:!1})}function a(a){var e=N,l=e.modal,i=e.t,c=a.$table,o=a.columns,s=a.options,e=a.file,u=c.internalData._importResolve,f=!1!==s.message,t=new FileReader;t.onerror=function(){d(a)},t.onload=function(e){var r=[],t=(o.forEach(function(e){e=e.field;e&&r.push(e)}),new j.default.Workbook),e=e.target;e?t.xlsx.load(e.result).then(function(e){var t,n,o,e=e.worksheets[0];e&&(e=e.getSheetValues(),t=_.default.findIndexOf(e,function(e){return e&&0<e.length}),n=e[t],o=r,n.some(function(e){return-1<o.indexOf(e)}))?(e=e.slice(t).map(function(e){var o={},t=(e.forEach(function(e,t){o[n[t]]=e}),{});return r.forEach(function(e){t[e]=_.default.isUndefined(o[e])?null:o[e]}),t}),c.createData(e).then(function(e){e="insert"===s.mode?c.insertAt(e,-1):c.reloadData(e);return e.then(function(){u&&u({status:!0})})}),f&&l&&l.message({content:i("vxe.table.impSuccess",[e.length]),status:"success"})):d(a)}):d(a)},t.readAsArrayBuffer(e)}function l(e){if("xlsx"===e.options.type)return a(e),!1}function i(e){if("xlsx"===e.options.type)return r(e),!1}var c={install:function(e){var t=e.setup,o=e.interceptor;N=e,t({export:{types:{xlsx:0}}}),o.mixin({"event.import":l,"event.export":i})}};e.VXETablePluginExportXLSX=c,"undefined"!=typeof window&&window.VXETable&&window.VXETable.use&&window.VXETable.use(c);e.default=c});